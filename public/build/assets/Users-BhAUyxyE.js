import{n as xe,r as w,j as e,y as x,T as i,B as m,K,L as ue,C as v,D as _,W as he,X as pe,Y as me,Z as F,$ as j,a0 as fe,O as L,a7 as Q,M as C,E as ge,Q as be,a8 as X,I as B,a1 as z,a2 as D,a3 as I,A as k,a4 as M,a5 as je,a6 as we,an as ve}from"./vendor-mui-core-CZp7bCIF.js";import{H as Ce,r as y}from"./vendor-inertia-Du7op6fS.js";import{S as Pe}from"./layouts-DoTfRa_D.js";import{a0 as Y,u as ye,a3 as Se,a4 as Z,v as Re,V as G,b as J}from"./vendor-mui-icons-D36_xVyV.js";import"./vendor-react-zq6P3Ky3.js";function De({users:O=[]}){const V=xe(),s=V.palette.custom,t=V.palette.mode==="dark",[U,ee]=w.useState(""),[S,R]=w.useState({open:!1,user:null}),[u,A]=w.useState({open:!1,user:null,newRole:null}),[n,h]=w.useState({open:!1,user:null,password:"",confirmPassword:"",error:""}),[o,l]=w.useState({open:!1,name:"",email:"",password:"",confirmPassword:"",role:"Author",error:"",showPassword:!1,showConfirmPassword:!1}),[f,d]=w.useState(null),[P,g]=w.useState({open:!1,message:"",severity:"success"}),re=(r,a)=>{const c=r.role||"Author";a==="Admin"||c==="Admin"&&a!=="Admin"?A({open:!0,user:r,newRole:a}):q(r.id,a,r.name)},q=(r,a,c)=>{d(r),y.patch(route("admin.users.updateRole",r),{role:a},{preserveScroll:!0,preserveState:!1,onSuccess:()=>{d(null),g({open:!0,message:`Updated ${c}'s role to ${a}`,severity:"success"})},onError:()=>{d(null),g({open:!0,message:"Failed to update role.",severity:"error"})}})},se=()=>{u.user&&(q(u.user.id,u.newRole,u.user.name),A({open:!1,user:null,newRole:null}))},oe=r=>R({open:!0,user:r}),ae=()=>{S.user&&y.delete(route("admin.users.delete",S.user.id),{preserveScroll:!0,onSuccess:()=>R({open:!1,user:null})})},te=r=>h({open:!0,user:r,password:"",confirmPassword:"",error:""}),ne=()=>{const{user:r,password:a,confirmPassword:c}=n;if(!a||a.length<8){h({...n,error:"Password must be at least 8 characters"});return}if(a!==c){h({...n,error:"Passwords do not match"});return}d(r.id),y.patch(route("admin.users.updatePassword",r.id),{password:a},{preserveScroll:!0,onSuccess:()=>{d(null),h({open:!1,user:null,password:"",confirmPassword:"",error:""}),g({open:!0,message:`Updated password for ${r.name}`,severity:"success"})},onError:T=>{d(null),h({...n,error:T.password||"Failed to update password."})}})},le=()=>{const{name:r,email:a,password:c,confirmPassword:T,role:H}=o;if(!r||!a||!c||!T||!H){l({...o,error:"All fields are required"});return}if(c.length<8){l({...o,error:"Password must be at least 8 characters"});return}if(c!==T){l({...o,error:"Passwords do not match"});return}d("creating"),y.post(route("admin.users.create"),{name:r,email:a,password:c,role:H},{preserveScroll:!0,onSuccess:()=>{d(null),l({open:!1,name:"",email:"",password:"",confirmPassword:"",role:"Author",error:""}),g({open:!0,message:`Created user ${r}`,severity:"success"})},onError:N=>{d(null),l({...o,error:N.email||N.password||"Failed to create user."})}})},ie=r=>{const a=!r.email_verified_at;d(r.id),y.patch(route("admin.users.toggleVerification",r.id),{verify:a},{preserveScroll:!0,onSuccess:()=>{d(null),g({open:!0,message:`${a?"Verified":"Unverified"} ${r.name}'s account`,severity:"success"})},onError:()=>{d(null),g({open:!0,message:"Failed to update verification.",severity:"error"})}})},$=O.filter(r=>r.name?.toLowerCase().includes(U.toLowerCase())||r.email?.toLowerCase().includes(U.toLowerCase())),b={borderBottom:`1px solid ${s.cardBorder}`,py:1.5,fontSize:"0.825rem",color:s.textPrimary},de={...b,fontWeight:700,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:s.textMuted,bgcolor:t?"rgba(0,0,0,0.15)":"#f9fafb"},ce=r=>{const a={Admin:{bg:t?"rgba(239,68,68,0.15)":"#fee2e2",color:"#dc2626"},Reviewer:{bg:t?"rgba(245,158,11,0.15)":"#fef3c7",color:"#d97706"},Author:{bg:t?"rgba(107,114,128,0.15)":"#f3f4f6",color:"#6b7280"}};return a[r]||a.Author},W={sx:{borderRadius:"16px",bgcolor:s.cardBg,border:`1px solid ${s.cardBorder}`}},p={"& .MuiOutlinedInput-root":{borderRadius:"10px","& fieldset":{borderColor:s.cardBorder},"&:hover fieldset":{borderColor:"#1abc9c"},"&.Mui-focused fieldset":{borderColor:"#1abc9c"}}},E={background:"linear-gradient(135deg, #0d7a6a 0%, #1abc9c 100%)","&:hover":{background:"linear-gradient(135deg, #16a085 0%, #0d7a6a 100%)"},borderRadius:"10px",textTransform:"none",fontWeight:600,px:3};return e.jsxs(Pe,{children:[e.jsx(Ce,{title:"User Management"}),e.jsxs(x,{sx:{p:{xs:2,sm:3,md:3.5},minHeight:"100vh",bgcolor:s.surfaceBg},children:[e.jsxs(x,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:3,gap:2},children:[e.jsxs(x,{children:[e.jsx(i,{variant:"h4",sx:{fontWeight:800,color:s.textPrimary,fontSize:{xs:"1.5rem",sm:"1.85rem"},letterSpacing:"-0.02em"},children:"User Management ðŸ‘¥"}),e.jsxs(i,{variant:"body2",sx:{color:s.textMuted,mt:.5},children:[O.length," registered users"]})]}),e.jsx(m,{variant:"contained",startIcon:e.jsx(Y,{}),onClick:()=>l({open:!0,name:"",email:"",password:"",confirmPassword:"",role:"Author",error:"",showPassword:!1,showConfirmPassword:!1}),sx:{...E,boxShadow:"0 4px 14px rgba(26,188,156,0.35)",py:1.2},children:"Add User"})]}),e.jsx(K,{elevation:0,sx:{borderRadius:"14px",border:`1px solid ${s.cardBorder}`,bgcolor:s.cardBg,mb:2.5},children:e.jsx(ue,{sx:{p:2,"&:last-child":{pb:2}},children:e.jsx(v,{fullWidth:!0,placeholder:"Search by name or email...",value:U,onChange:r=>ee(r.target.value),size:"small",InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(ye,{sx:{color:s.textMuted,fontSize:20}})})},sx:{...p,"& .MuiOutlinedInput-root":{...p["& .MuiOutlinedInput-root"],bgcolor:t?"rgba(0,0,0,0.15)":"#f9fafb"},"& input":{color:s.textPrimary,fontSize:"0.85rem"}}})})}),e.jsxs(K,{elevation:0,sx:{borderRadius:"16px",border:`1px solid ${s.cardBorder}`,bgcolor:s.cardBg,overflow:"hidden"},children:[e.jsx(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:2.5,py:2,borderBottom:`1px solid ${s.cardBorder}`},children:e.jsxs(i,{sx:{fontWeight:700,color:s.textPrimary,fontSize:"0.95rem"},children:["All Users (",$.length,")"]})}),e.jsx(he,{children:e.jsxs(pe,{size:"small",children:[e.jsx(me,{children:e.jsx(F,{children:["Name","Email","Role","Account Status","Registered","Actions"].map(r=>e.jsx(j,{sx:de,children:r},r))})}),e.jsx(fe,{children:$.length===0?e.jsx(F,{children:e.jsx(j,{colSpan:6,align:"center",sx:b,children:e.jsxs(x,{sx:{py:5},children:[e.jsx(Se,{sx:{fontSize:48,color:t?"#374151":"#d1d5db",mb:1}}),e.jsx(i,{variant:"body2",sx:{color:s.textMuted},children:"No users found"})]})})}):$.map(r=>{const a=ce(r.role||"Author");return e.jsxs(F,{hover:!0,sx:{"&:hover":{bgcolor:t?"rgba(255,255,255,0.02)":"#f9fafb"}},children:[e.jsx(j,{sx:b,children:e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(L,{sx:{width:34,height:34,bgcolor:"#1abc9c",fontSize:"0.8rem",fontWeight:700},children:(r.name||"U").charAt(0)}),e.jsx(i,{variant:"body2",sx:{fontWeight:600,color:s.textPrimary,fontSize:"0.85rem"},children:r.name})]})}),e.jsx(j,{sx:b,children:e.jsx(i,{variant:"body2",sx:{fontSize:"0.825rem",color:s.textMuted},children:r.email})}),e.jsx(j,{sx:b,children:e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(Q,{value:r.role||"Author",onChange:c=>re(r,c.target.value),size:"small",disabled:f===r.id,sx:{minWidth:110,borderRadius:"8px",fontSize:"0.8rem",fontWeight:600,bgcolor:a.bg,color:a.color,"& .MuiSelect-select":{py:.75},"& fieldset":{borderColor:"transparent"},"&:hover fieldset":{borderColor:a.color}},children:[e.jsx(C,{value:"Author",children:"Author"}),e.jsx(C,{value:"Reviewer",children:"Reviewer"}),e.jsx(C,{value:"Admin",children:"Admin"})]}),f===r.id&&e.jsx(ge,{size:18,sx:{color:"#1abc9c"}})]})}),e.jsx(j,{sx:b,children:e.jsx(be,{label:r.email_verified_at?"âœ“ Verified":"âš  Unverified",size:"small",onClick:()=>ie(r),sx:{bgcolor:r.email_verified_at?t?"rgba(22,163,74,0.15)":"#dcfce7":t?"rgba(245,158,11,0.15)":"#fef3c7",color:r.email_verified_at?"#16a34a":"#d97706",fontWeight:600,fontSize:"0.7rem",borderRadius:"6px",height:24,cursor:"pointer","&:hover":{opacity:.85}}})}),e.jsx(j,{sx:b,children:e.jsx(i,{variant:"body2",sx:{fontSize:"0.8rem",color:s.textMuted},children:new Date(r.created_at).toLocaleDateString("id-ID")})}),e.jsx(j,{sx:b,children:e.jsxs(x,{sx:{display:"flex",gap:.5},children:[e.jsx(X,{title:"Edit Password",children:e.jsx(B,{size:"small",onClick:()=>te(r),sx:{color:"#1abc9c","&:hover":{bgcolor:t?"rgba(26,188,156,0.1)":"#ecfdf5"}},children:e.jsx(Z,{sx:{fontSize:18}})})}),e.jsx(X,{title:"Delete User",children:e.jsx(B,{size:"small",onClick:()=>oe(r),sx:{color:t?"#f87171":"#ef4444","&:hover":{bgcolor:t?"rgba(239,68,68,0.1)":"#fee2e2"}},children:e.jsx(Re,{sx:{fontSize:18}})})})]})})]},r.id)})})]})})]})]}),e.jsxs(z,{open:u.open,onClose:()=>A({open:!1,user:null,newRole:null}),maxWidth:"sm",fullWidth:!0,PaperProps:W,children:[e.jsx(D,{sx:{fontWeight:700,color:"#dc2626",borderBottom:`1px solid ${s.cardBorder}`,pb:2},children:"âš ï¸ Critical Role Change"}),e.jsxs(I,{sx:{pt:2.5},children:[e.jsxs(x,{sx:{p:2,bgcolor:t?"rgba(245,158,11,0.08)":"#fff7ed",borderRadius:"10px",border:`1px solid ${t?"rgba(245,158,11,0.2)":"#fed7aa"}`,mb:2,mt:1},children:[e.jsxs(i,{variant:"body2",sx:{color:s.textPrimary,mb:.5},children:[e.jsx("strong",{children:"User:"})," ",u.user?.name]}),e.jsxs(i,{variant:"body2",sx:{color:s.textPrimary,mb:.5},children:[e.jsx("strong",{children:"Current:"})," ",u.user?.role||"Author"]}),e.jsxs(i,{variant:"body2",sx:{color:s.textPrimary},children:[e.jsx("strong",{children:"New:"})," ",u.newRole]})]}),e.jsx(k,{severity:"warning",sx:{borderRadius:"10px",mb:2},children:u.newRole==="Admin"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Warning:"})," This user will receive full admin access."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Warning:"})," Admin privileges will be revoked."]})})]}),e.jsxs(M,{sx:{p:2.5,borderTop:`1px solid ${s.cardBorder}`},children:[e.jsx(m,{onClick:()=>A({open:!1,user:null,newRole:null}),sx:{borderRadius:"10px",textTransform:"none",fontWeight:600,color:s.textMuted},children:"Cancel"}),e.jsx(m,{onClick:se,variant:"contained",sx:{bgcolor:"#dc2626","&:hover":{bgcolor:"#b91c1c"},borderRadius:"10px",textTransform:"none",fontWeight:600},children:"Confirm"})]})]}),e.jsxs(z,{open:S.open,onClose:()=>R({open:!1,user:null}),PaperProps:W,children:[e.jsx(D,{sx:{fontWeight:700,color:"#dc2626",borderBottom:`1px solid ${s.cardBorder}`,pb:2},children:"Delete User"}),e.jsx(I,{sx:{pt:2.5},children:e.jsxs(i,{sx:{color:s.textPrimary,mt:1},children:["Are you sure you want to delete ",e.jsx("strong",{children:S.user?.name}),"? This cannot be undone."]})}),e.jsxs(M,{sx:{p:2.5,borderTop:`1px solid ${s.cardBorder}`},children:[e.jsx(m,{onClick:()=>R({open:!1,user:null}),sx:{borderRadius:"10px",textTransform:"none",fontWeight:600,color:s.textMuted},children:"Cancel"}),e.jsx(m,{onClick:ae,variant:"contained",sx:{bgcolor:"#dc2626","&:hover":{bgcolor:"#b91c1c"},borderRadius:"10px",textTransform:"none",fontWeight:600},children:"Delete"})]})]}),e.jsxs(z,{open:n.open,onClose:()=>h({open:!1,user:null,password:"",confirmPassword:"",error:""}),maxWidth:"sm",fullWidth:!0,PaperProps:W,children:[e.jsx(D,{sx:{fontWeight:700,color:s.textPrimary,borderBottom:`1px solid ${s.cardBorder}`,pb:2},children:e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(L,{variant:"rounded",sx:{bgcolor:t?"rgba(26,188,156,0.12)":"#ecfdf5",width:40,height:40,borderRadius:"10px"},children:e.jsx(Z,{sx:{color:"#1abc9c",fontSize:22}})}),e.jsxs(x,{children:[e.jsx(i,{sx:{fontWeight:700,fontSize:"1rem"},children:"Edit Password"}),e.jsx(i,{variant:"caption",sx:{color:s.textMuted},children:n.user?.name})]})]})}),e.jsxs(I,{sx:{pt:2.5},children:[n.error&&e.jsx(k,{severity:"error",sx:{borderRadius:"10px",mb:2,mt:1},children:n.error}),e.jsx(v,{fullWidth:!0,label:"New Password",type:"password",value:n.password,onChange:r=>h({...n,password:r.target.value,error:""}),sx:{mb:2,mt:1,...p},helperText:"Minimum 8 characters"}),e.jsx(v,{fullWidth:!0,label:"Confirm Password",type:"password",value:n.confirmPassword,onChange:r=>h({...n,confirmPassword:r.target.value,error:""}),sx:p})]}),e.jsxs(M,{sx:{p:2.5,borderTop:`1px solid ${s.cardBorder}`},children:[e.jsx(m,{onClick:()=>h({open:!1,user:null,password:"",confirmPassword:"",error:""}),disabled:f===n.user?.id,sx:{borderRadius:"10px",textTransform:"none",fontWeight:600,color:s.textMuted},children:"Cancel"}),e.jsx(m,{onClick:ne,variant:"contained",disabled:f===n.user?.id,sx:E,children:f===n.user?.id?"Updating...":"Update"})]})]}),e.jsxs(z,{open:o.open,onClose:()=>l({open:!1,name:"",email:"",password:"",confirmPassword:"",role:"Author",error:""}),maxWidth:"sm",fullWidth:!0,PaperProps:W,children:[e.jsx(D,{sx:{fontWeight:700,color:s.textPrimary,borderBottom:`1px solid ${s.cardBorder}`,pb:2},children:e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(L,{variant:"rounded",sx:{bgcolor:t?"rgba(26,188,156,0.12)":"#ecfdf5",width:40,height:40,borderRadius:"10px"},children:e.jsx(Y,{sx:{color:"#1abc9c",fontSize:22}})}),e.jsx(i,{sx:{fontWeight:700,fontSize:"1rem"},children:"Create User"})]})}),e.jsxs(I,{sx:{pt:2.5},children:[o.error&&e.jsx(k,{severity:"error",sx:{borderRadius:"10px",mb:2,mt:1},children:o.error}),e.jsx(v,{fullWidth:!0,label:"Full Name",value:o.name,onChange:r=>l({...o,name:r.target.value,error:""}),sx:{mb:2,mt:1,...p},required:!0}),e.jsx(v,{fullWidth:!0,label:"Email",type:"email",value:o.email,onChange:r=>l({...o,email:r.target.value,error:""}),sx:{mb:2,...p},required:!0}),e.jsx(v,{fullWidth:!0,label:"Password",type:o.showPassword?"text":"password",value:o.password,onChange:r=>l({...o,password:r.target.value,error:""}),sx:{mb:2,...p},helperText:"Minimum 8 characters",required:!0,InputProps:{endAdornment:e.jsx(_,{position:"end",children:e.jsx(B,{onClick:()=>l({...o,showPassword:!o.showPassword}),edge:"end",children:o.showPassword?e.jsx(G,{}):e.jsx(J,{})})})}}),e.jsx(v,{fullWidth:!0,label:"Confirm Password",type:o.showConfirmPassword?"text":"password",value:o.confirmPassword,onChange:r=>l({...o,confirmPassword:r.target.value,error:""}),sx:{mb:2,...p},required:!0,InputProps:{endAdornment:e.jsx(_,{position:"end",children:e.jsx(B,{onClick:()=>l({...o,showConfirmPassword:!o.showConfirmPassword}),edge:"end",children:o.showConfirmPassword?e.jsx(G,{}):e.jsx(J,{})})})}}),e.jsxs(je,{fullWidth:!0,sx:p,children:[e.jsx(we,{children:"Role"}),e.jsxs(Q,{value:o.role,label:"Role",onChange:r=>l({...o,role:r.target.value,error:""}),sx:{borderRadius:"10px"},children:[e.jsx(C,{value:"Author",children:"Author"}),e.jsx(C,{value:"Reviewer",children:"Reviewer"}),e.jsx(C,{value:"Admin",children:"Admin"})]})]})]}),e.jsxs(M,{sx:{p:2.5,borderTop:`1px solid ${s.cardBorder}`},children:[e.jsx(m,{onClick:()=>l({open:!1,name:"",email:"",password:"",confirmPassword:"",role:"Author",error:""}),disabled:f==="creating",sx:{borderRadius:"10px",textTransform:"none",fontWeight:600,color:s.textMuted},children:"Cancel"}),e.jsx(m,{onClick:le,variant:"contained",disabled:f==="creating",sx:E,children:f==="creating"?"Creating...":"Create User"})]})]}),e.jsx(ve,{open:P.open,autoHideDuration:4e3,onClose:()=>g({...P,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(k,{onClose:()=>g({...P,open:!1}),severity:P.severity,variant:"filled",sx:{width:"100%",borderRadius:"10px"},children:P.message})})]})}export{De as default};
