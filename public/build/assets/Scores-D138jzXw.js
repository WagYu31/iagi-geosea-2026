import{n as Q,r as R,j as e,y as g,T as d,B as X,K as _,L as B,O as F,R as Z,C as G,D as J,a6 as L,a7 as N,a8 as $,M as b,W as V,X as ee,Y as re,Z as C,$ as u,a0 as te,Q as T}from"./vendor-mui-core-BP7c3UfX.js";import{H as oe}from"./vendor-inertia-9DL0UMyN.js";import{S as se}from"./layouts-D0TRlhgN.js";import{A as ae,p as le,q as ne,$ as ie,u as ce,a0 as de}from"./vendor-mui-icons-C8sdnAIj.js";import"./vendor-react-zq6P3Ky3.js";function me({submissions:j=[]}){const W=Q(),t=W.palette.custom,o=W.palette.mode==="dark",[I,k]=R.useState(""),[z,P]=R.useState("highest"),[A,E]=R.useState("all"),w=r=>{if(!r||r.length===0)return"N/A";const n=r.filter(l=>l.overall_score);return n.length===0?"N/A":(n.reduce((l,f)=>{const c=(parseInt(f.originality_score||0)+parseInt(f.relevance_score||0)+parseInt(f.clarity_score||0)+parseInt(f.methodology_score||0)+parseInt(f.overall_score||0))/5;return l+c},0)/n.length).toFixed(1)},O=r=>({accepted:{bg:o?"rgba(22,163,74,0.15)":"#dcfce7",color:"#16a34a"},rejected:{bg:o?"rgba(239,68,68,0.15)":"#fee2e2",color:"#dc2626"},under_review:{bg:o?"rgba(37,99,235,0.15)":"#dbeafe",color:"#2563eb"},"under review":{bg:o?"rgba(37,99,235,0.15)":"#dbeafe",color:"#2563eb"},revision_required_phase1:{bg:o?"rgba(245,158,11,0.15)":"#fef3c7",color:"#d97706"},revision_required_phase2:{bg:o?"rgba(245,158,11,0.15)":"#fef3c7",color:"#d97706"}})[r?.toLowerCase()]||{bg:o?"rgba(107,114,128,0.15)":"#f3f4f6",color:"#6b7280"};let p=j.filter(r=>r.title?.toLowerCase().includes(I.toLowerCase())||r.user?.name?.toLowerCase().includes(I.toLowerCase()));z!=="none"&&(p=[...p].sort((r,n)=>{const i=w(r.reviews),l=w(n.reviews);return i==="N/A"&&l==="N/A"?0:i==="N/A"?1:l==="N/A"?-1:z==="highest"?parseFloat(l)-parseFloat(i):parseFloat(i)-parseFloat(l)}));const H=p.length;A!=="all"&&(p=p.slice(0,parseInt(A)));const M=j.filter(r=>r.reviews?.some(n=>n.overall_score)).length,U=j.length-M,m={borderBottom:`1px solid ${t.cardBorder}`,py:1.5,fontSize:"0.825rem",color:t.textPrimary},D={...m,fontWeight:700,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:t.textMuted,bgcolor:o?"rgba(0,0,0,0.15)":"#f9fafb"},y={"& .MuiOutlinedInput-root":{borderRadius:"10px","& fieldset":{borderColor:t.cardBorder},"&:hover fieldset":{borderColor:"#1abc9c"},"&.Mui-focused fieldset":{borderColor:"#1abc9c"}}},q=()=>{const r=Math.max(...p.map(s=>s.reviews?.filter(x=>x.overall_score)?.length||0),1),n=["#","Submission Code","Title","Author","Email","Status","Assigned","Completed","Avg Score"];for(let s=1;s<=r;s++)n.push(`Reviewer ${s} Name`,`Reviewer ${s} Score`);const i=p.map(s=>{const x=w(s.reviews),h=s.reviews?.filter(a=>a.overall_score)||[],v=[s.id,s.submission_code||"",`"${(s.title||"").replace(/"/g,'""')}"`,`"${(s.user?.name||"Unknown").replace(/"/g,'""')}"`,s.user?.email||"",s.status||"",s.reviews?.length||0,h.length,x];for(let a=0;a<r;a++)if(h[a]){const K=((parseInt(h[a].originality_score||0)+parseInt(h[a].relevance_score||0)+parseInt(h[a].clarity_score||0)+parseInt(h[a].methodology_score||0)+parseInt(h[a].overall_score||0))/5).toFixed(1);v.push(`"${(h[a].reviewer?.name||"Reviewer "+(a+1)).replace(/"/g,'""')}"`,K)}else v.push("","");return v.join(",")}),l="\uFEFF"+n.join(",")+`
`+i.join(`
`),f=new Blob([l],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(f),S=document.createElement("a");S.href=c,S.download=`scores_rankings_${new Date().toISOString().slice(0,10)}.csv`,S.click(),URL.revokeObjectURL(c)},Y=[{label:"Total Submissions",value:j.length,icon:e.jsx(ae,{}),color:"#1abc9c",bg:o?"rgba(26,188,156,0.12)":"#ecfdf5"},{label:"With Scores",value:M,icon:e.jsx(le,{}),color:"#2563eb",bg:o?"rgba(37,99,235,0.12)":"#dbeafe"},{label:"Pending Review",value:U,icon:e.jsx(ne,{}),color:"#d97706",bg:o?"rgba(245,158,11,0.12)":"#fef3c7"}];return e.jsxs(se,{children:[e.jsx(oe,{title:"Scores"}),e.jsxs(g,{sx:{p:{xs:2,sm:3,md:3.5},minHeight:"100vh",bgcolor:t.surfaceBg},children:[e.jsxs(g,{sx:{mb:3},children:[e.jsx(d,{variant:"h4",sx:{fontWeight:800,color:t.textPrimary,fontSize:{xs:"1.5rem",sm:"1.85rem"},letterSpacing:"-0.02em"},children:"Scores & Rankings ðŸ“Š"}),e.jsxs(d,{variant:"body2",sx:{color:t.textMuted,mt:.5},children:[j.length," submissions tracked"]}),e.jsx(X,{variant:"contained",startIcon:e.jsx(ie,{}),onClick:q,sx:{mt:1.5,bgcolor:"#1abc9c",color:"#fff",fontWeight:700,fontSize:"0.8rem",borderRadius:"10px",textTransform:"none",px:2.5,"&:hover":{bgcolor:"#16a085"}},children:"Export Excel"})]}),e.jsx(g,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr 1fr"},gap:2,mb:3},children:Y.map(r=>e.jsx(_,{elevation:0,sx:{borderRadius:"14px",border:`1px solid ${t.cardBorder}`,bgcolor:t.cardBg,transition:"all 0.25s","&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${o?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.08)"}`}},children:e.jsx(B,{sx:{p:2.5,"&:last-child":{pb:2.5}},children:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(F,{variant:"rounded",sx:{bgcolor:r.bg,width:44,height:44,borderRadius:"12px"},children:Z.cloneElement(r.icon,{sx:{color:r.color,fontSize:22}})}),e.jsxs(g,{children:[e.jsx(d,{variant:"caption",sx:{color:t.textMuted,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",fontSize:"0.7rem"},children:r.label}),e.jsx(d,{sx:{fontWeight:700,fontSize:"1.25rem",color:t.textPrimary,lineHeight:1.2},children:r.value})]})]})})},r.label))}),e.jsx(_,{elevation:0,sx:{borderRadius:"14px",border:`1px solid ${t.cardBorder}`,bgcolor:t.cardBg,mb:2.5},children:e.jsx(B,{sx:{p:2,"&:last-child":{pb:2}},children:e.jsxs(g,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(G,{fullWidth:!0,placeholder:"Search by title or author...",value:I,onChange:r=>k(r.target.value),size:"small",InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(ce,{sx:{color:t.textMuted,fontSize:20}})})},sx:{flex:1,minWidth:250,...y,"& .MuiOutlinedInput-root":{...y["& .MuiOutlinedInput-root"],bgcolor:o?"rgba(0,0,0,0.15)":"#f9fafb"},"& input":{color:t.textPrimary,fontSize:"0.85rem"}}}),e.jsxs(L,{size:"small",sx:{minWidth:180,...y},children:[e.jsx(N,{sx:{color:t.textMuted},children:"Sort by Score"}),e.jsxs($,{value:z,label:"Sort by Score",onChange:r=>P(r.target.value),sx:{bgcolor:o?"rgba(0,0,0,0.15)":"#f9fafb",color:t.textPrimary,fontSize:"0.85rem"},children:[e.jsx(b,{value:"highest",children:"Highest â†’ Lowest"}),e.jsx(b,{value:"lowest",children:"Lowest â†’ Highest"}),e.jsx(b,{value:"none",children:"No Sorting"})]})]}),e.jsxs(L,{size:"small",sx:{minWidth:140,...y},children:[e.jsx(N,{sx:{color:t.textMuted},children:"Show Top"}),e.jsxs($,{value:A,label:"Show Top",onChange:r=>E(r.target.value),sx:{bgcolor:o?"rgba(0,0,0,0.15)":"#f9fafb",color:t.textPrimary,fontSize:"0.85rem"},children:[e.jsxs(b,{value:"all",children:["All (",H,")"]}),e.jsx(b,{value:"50",children:"Top 50"}),e.jsx(b,{value:"20",children:"Top 20"}),e.jsx(b,{value:"10",children:"Top 10"}),e.jsx(b,{value:"3",children:"Top 3"})]})]})]})})}),e.jsx(_,{elevation:0,sx:{borderRadius:"16px",border:`1px solid ${t.cardBorder}`,bgcolor:t.cardBg,overflow:"hidden"},children:e.jsx(V,{children:e.jsxs(ee,{size:"small",children:[e.jsx(re,{children:e.jsx(C,{children:["#","Title","Author","Status","Reviewers","Avg Score","Detail"].map(r=>e.jsx(u,{sx:D,align:r==="Avg Score"?"center":"left",children:r},r))})}),e.jsx(te,{children:p.length===0?e.jsx(C,{children:e.jsx(u,{colSpan:7,align:"center",sx:m,children:e.jsxs(g,{sx:{py:5},children:[e.jsx(de,{sx:{fontSize:48,color:o?"#374151":"#d1d5db",mb:1}}),e.jsx(d,{variant:"body2",sx:{color:t.textMuted},children:"No submissions found"})]})})}):p.map((r,n)=>{const i=w(r.reviews),l=r.reviews?.filter(x=>x.overall_score)||[],f=O(r.status),c=i!=="N/A"?parseFloat(i):null,S=c!==null?c>=4?o?"rgba(22,163,74,0.15)":"#dcfce7":c>=3?o?"rgba(245,158,11,0.15)":"#fef3c7":o?"rgba(239,68,68,0.15)":"#fee2e2":"transparent",s=c!==null?c>=4?"#16a34a":c>=3?"#d97706":"#dc2626":t.textMuted;return e.jsxs(C,{hover:!0,sx:{"&:hover":{bgcolor:o?"rgba(255,255,255,0.02)":"#f9fafb"}},children:[e.jsxs(u,{sx:{...m,fontWeight:600,color:t.textMuted,fontSize:"0.8rem"},children:["#",r.id]}),e.jsx(u,{sx:{...m,maxWidth:250},children:e.jsx(d,{variant:"body2",noWrap:!0,sx:{fontWeight:600,fontSize:"0.825rem",maxWidth:250},children:r.title})}),e.jsx(u,{sx:m,children:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(F,{sx:{width:30,height:30,bgcolor:"#1abc9c",fontSize:"0.75rem",fontWeight:700},children:(r.user?.name||"U").charAt(0)}),e.jsx(d,{variant:"body2",sx:{fontSize:"0.825rem",color:t.textPrimary},children:r.user?.name||"Unknown"})]})}),e.jsx(u,{sx:m,children:e.jsx(T,{label:r.status,size:"small",sx:{bgcolor:f.bg,color:f.color,fontWeight:600,fontSize:"0.7rem",borderRadius:"6px",height:24}})}),e.jsxs(u,{sx:m,children:[e.jsxs(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.825rem"},children:[r.reviews?.length||0," assigned"]}),e.jsxs(d,{variant:"caption",sx:{color:t.textMuted,fontSize:"0.7rem"},children:[l.length," completed"]})]}),e.jsx(u,{align:"center",sx:m,children:c!==null?e.jsx(g,{sx:{display:"inline-flex",alignItems:"center",bgcolor:S,color:s,px:2,py:.75,borderRadius:"8px",minWidth:55},children:e.jsx(d,{sx:{fontWeight:700,fontSize:"1rem",lineHeight:1},children:i})}):e.jsx(T,{label:"N/A",size:"small",sx:{bgcolor:o?"rgba(107,114,128,0.15)":"#f3f4f6",color:"#6b7280",fontWeight:600,fontSize:"0.7rem",borderRadius:"6px",height:24}})}),e.jsx(u,{sx:m,children:l.length>0?e.jsx(g,{sx:{display:"flex",flexDirection:"column",gap:.5},children:l.map((x,h)=>{const v=((parseInt(x.originality_score||0)+parseInt(x.relevance_score||0)+parseInt(x.clarity_score||0)+parseInt(x.methodology_score||0)+parseInt(x.overall_score||0))/5).toFixed(1),a=parseFloat(v);return e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(d,{variant:"caption",sx:{fontWeight:600,minWidth:70,color:t.textMuted,fontSize:"0.7rem"},children:["Reviewer ",h+1,":"]}),e.jsx(T,{label:v,size:"small",sx:{bgcolor:a>=4?o?"rgba(22,163,74,0.15)":"#dcfce7":a>=3?o?"rgba(245,158,11,0.15)":"#fef3c7":o?"rgba(239,68,68,0.15)":"#fee2e2",color:a>=4?"#16a34a":a>=3?"#d97706":"#dc2626",fontWeight:600,fontSize:"0.7rem",borderRadius:"6px",height:22}})]},h)})}):e.jsx(d,{variant:"caption",sx:{fontStyle:"italic",color:t.textMuted,fontSize:"0.75rem"},children:"No scores yet"})})]},r.id)})})]})})})]})]})}export{me as default};
